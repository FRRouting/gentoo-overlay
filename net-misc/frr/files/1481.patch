From 28a465c604a066d06a096660473600c2728d7b0f Mon Sep 17 00:00:00 2001
From: Andrey Korolyov <andrey@xdel.ru>
Date: Sun, 26 Nov 2017 04:13:54 +0300
Subject: [PATCH] bgpd: fix RPKI-enabled build

Signed-off-by: Andrey Korolyov <andrey@xdel.ru>
---
 bgpd/Makefile.am | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

diff --git a/bgpd/Makefile.am b/bgpd/Makefile.am
index 19cb1cf03..fa1dcbb76 100644
--- a/bgpd/Makefile.am
+++ b/bgpd/Makefile.am
@@ -73,6 +73,8 @@ module_LTLIBRARIES =
 sbin_PROGRAMS = bgpd
 bin_PROGRAMS = bgp_btoa
 
+BUILT_SOURCES = 
+
 libbgp_a_SOURCES = \
 	bgp_memory.c \
 	bgpd.c bgp_fsm.c bgp_aspath.c bgp_community.c bgp_attr.c \
@@ -116,13 +118,9 @@ bgpd_snmp_la_LIBADD = ../lib/libfrrsnmp.la
 
 if RPKI
 module_LTLIBRARIES += bgpd_rpki.la
+BUILT_SOURCES += bgp_rpki_clippy.c
 endif
 
-bgpd_rpki_la-bgp_rpki.o: bgp_rpki_clippy.c
-bgp_rpki.la: bgp_rpki_clippy.c
-bgp_rpki.lo: bgp_rpki_clippy.c
-bgp_rpki.o: bgp_rpki_clippy.c
-
 bgpd_rpki_la_SOURCES = bgp_rpki.c
 bgpd_rpki_la_CFLAGS = $(WERROR) $(RTRLIB_CFLAGS)
 bgpd_rpki_la_LDFLAGS = -avoid-version -module -shared -export-dynamic
